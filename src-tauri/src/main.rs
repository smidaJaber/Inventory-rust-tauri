// Prevents additional console window on Windows in release, DO NOT REMOVE!!
#![cfg_attr(not(debug_assertions), windows_subsystem = "windows")]
#![allow(unused)]
#![allow(unused_variables)]
mod cmds;
mod database;
mod models;
mod schema;
mod utils;
use dbs::DatabaseState;
#[allow(warnings, unused)]
use specta::collect_types;
use std::sync::Arc;
use tauri::{Manager, RunEvent};
use tauri_specta::ts;

mod config;
mod dbs;
#[tokio::main]
async fn main() {
    #[cfg(debug_assertions)]
    ts::export(
        collect_types![
            cmds::auth::get_user_by_email_pwd,
            cmds::comptebancaire::get_all_comptebancaires,
            cmds::comptebancaire::get_comptebancaire_by_id,
            cmds::comptebancaire::update_comptebancaire,
            cmds::comptebancaire::delete_comptebancaire,
            cmds::comptebancaire::insert_comptebancaire,
            cmds::depense::get_all_depenses,
            cmds::depense::get_depense_by_id,
            cmds::depense::update_depense,
            cmds::depense::delete_depense,
            cmds::depense::insert_depense,
            cmds::document::get_all_documents,
            cmds::document::get_document_by_id,
            cmds::document::update_document,
            cmds::document::delete_document,
            cmds::document::insert_document,
            cmds::emballage::get_all_emballages,
            cmds::emballage::get_emballage_by_id,
            cmds::emballage::update_emballage,
            cmds::emballage::delete_emballage,
            cmds::emballage::insert_emballage,
            cmds::entreprise::get_all_entreprises,
            cmds::entreprise::get_entreprise_by_id,
            cmds::entreprise::update_entreprise,
            cmds::entreprise::delete_entreprise,
            cmds::entreprise::insert_entreprise,
            cmds::equipement::get_all_equipements,
            cmds::equipement::get_equipement_by_id,
            cmds::equipement::update_equipement,
            cmds::equipement::delete_equipement,
            cmds::equipement::insert_equipement,
            cmds::facture::get_all_factures,
            cmds::facture::get_facture_by_id,
            cmds::facture::update_facture,
            cmds::facture::delete_facture,
            cmds::facture::insert_facture,
            cmds::factureexport::get_all_factureexports,
            cmds::factureexport::get_factureexport_by_id,
            cmds::factureexport::update_factureexport,
            cmds::factureexport::delete_factureexport,
            cmds::factureexport::insert_factureexport,
            cmds::fournisseur::get_all_fournisseurs,
            cmds::fournisseur::get_fournisseur_by_id,
            cmds::fournisseur::update_fournisseur,
            cmds::fournisseur::delete_fournisseur,
            cmds::fournisseur::insert_fournisseur,
            cmds::lieustockage::get_all_lieustockages,
            cmds::lieustockage::get_lieustockage_by_id,
            cmds::lieustockage::update_lieustockage,
            cmds::lieustockage::delete_lieustockage,
            cmds::lieustockage::insert_lieustockage,
            cmds::lieutravail::get_all_lieutravails,
            cmds::lieutravail::get_lieutravail_by_id,
            cmds::lieutravail::update_lieutravail,
            cmds::lieutravail::delete_lieutravail,
            cmds::lieutravail::insert_lieutravail,
            cmds::local::get_all_locals,
            cmds::local::get_local_by_id,
            cmds::local::update_local,
            cmds::local::delete_local,
            cmds::local::insert_local,
            cmds::paiement::get_all_paiements,
            cmds::paiement::get_paiement_by_id,
            cmds::paiement::update_paiement,
            cmds::paiement::delete_paiement,
            cmds::paiement::insert_paiement,
            cmds::personnel::get_all_personnels,
            cmds::personnel::get_personnel_by_id,
            cmds::personnel::update_personnel,
            cmds::personnel::delete_personnel,
            cmds::personnel::insert_personnel,
            cmds::produit::get_all_produits,
            cmds::produit::get_produit_by_id,
            cmds::produit::update_produit,
            cmds::produit::delete_produit,
            cmds::produit::insert_produit,
            cmds::saison::get_all_saisons,
            cmds::saison::get_saison_by_id,
            cmds::saison::update_saison,
            cmds::saison::delete_saison,
            cmds::saison::insert_saison,
            cmds::session::get_all_sessions,
            cmds::session::get_session_by_id,
            cmds::session::update_session,
            cmds::session::delete_session,
            cmds::session::insert_session,
            cmds::setting::get_all_settings,
            cmds::setting::get_setting_by_id,
            cmds::setting::update_setting,
            cmds::setting::delete_setting,
            cmds::setting::insert_setting,
            cmds::tableachat::get_all_tableachats,
            cmds::tableachat::get_all_opps_achat_multi_db,
            cmds::tableachat::get_tableachat_by_id,
            cmds::tableachat::update_tableachat,
            cmds::tableachat::delete_tableachat,
            cmds::tableachat::insert_tableachat,
            cmds::tablearchivedoc::get_all_tablearchivedocs,
            cmds::tablearchivedoc::get_tablearchivedoc_by_id,
            cmds::tablearchivedoc::update_tablearchivedoc,
            cmds::tablearchivedoc::delete_tablearchivedoc,
            cmds::tablearchivedoc::insert_tablearchivedoc,
            cmds::tabledepense::get_all_tabledepenses,
            cmds::tabledepense::get_tabledepense_by_id,
            cmds::tabledepense::update_tabledepense,
            cmds::tabledepense::delete_tabledepense,
            cmds::tabledepense::insert_tabledepense,
            cmds::tabledocdoc::get_all_tabledocdocs,
            cmds::tabledocdoc::get_tabledocdoc_by_id,
            cmds::tabledocdoc::update_tabledocdoc,
            cmds::tabledocdoc::delete_tabledocdoc,
            cmds::tabledocdoc::insert_tabledocdoc,
            cmds::tablefactureavoir::get_all_tablefactureavoirs,
            cmds::tablefactureavoir::get_tablefactureavoir_by_id,
            cmds::tablefactureavoir::update_tablefactureavoir,
            cmds::tablefactureavoir::delete_tablefactureavoir,
            cmds::tablefactureavoir::insert_tablefactureavoir,
            cmds::tablepointage::get_all_tablepointages,
            cmds::tablepointage::get_tablepointage_by_id,
            cmds::tablepointage::update_tablepointage,
            cmds::tablepointage::delete_tablepointage,
            cmds::tablepointage::insert_tablepointage,
            cmds::tableressourceachat::get_all_tableressourceachats,
            cmds::tableressourceachat::get_all_ress_achat_multi_db,
            cmds::tableressourceachat::get_tableressourceachat_by_id,
            cmds::tableressourceachat::update_tableressourceachat,
            cmds::tableressourceachat::delete_tableressourceachat,
            cmds::tableressourceachat::insert_tableressourceachat,
            cmds::tableressourcevente::get_all_tableressourceventes,
            cmds::tableressourcevente::get_tableressourcevente_by_id,
            cmds::tableressourcevente::update_tableressourcevente,
            cmds::tableressourcevente::delete_tableressourcevente,
            cmds::tableressourcevente::insert_tableressourcevente,
            cmds::tabletransfert::get_all_tabletransferts,
            cmds::tabletransfert::get_tabletransfert_by_id,
            cmds::tabletransfert::update_tabletransfert,
            cmds::tabletransfert::delete_tabletransfert,
            cmds::tabletransfert::insert_tabletransfert,
            cmds::tablevente::get_all_tableventes,
            cmds::tablevente::get_tablevente_by_id,
            cmds::tablevente::update_tablevente,
            cmds::tablevente::delete_tablevente,
            cmds::tablevente::insert_tablevente,
            cmds::typeproduit::get_all_typeproduits,
            cmds::typeproduit::get_typeproduit_by_id,
            cmds::typeproduit::update_typeproduit,
            cmds::typeproduit::delete_typeproduit,
            cmds::typeproduit::insert_typeproduit,
            cmds::user::get_all_users,
            cmds::user::get_user_by_id,
            cmds::user::update_user,
            cmds::user::delete_user,
            cmds::user::insert_user,
            cmds::database_cmd::export_db,
            //get from all databases
            cmds::fournisseur::get_all_fournisseurs_multi_db,
            //helpers
            cmds::helper_functions::get_totaux,
            cmds::helper_functions::get_totaux_ress,
            cmds::helper_functions::get_totaux_opps
        ],
        "../src/bindings.ts",
    )
    .unwrap();

    tauri::Builder::default()
        .setup(|_app| {
            // Initialize the database.
            database::init();

            Ok(())
        })
        .invoke_handler(tauri::generate_handler![
            config::load_config,
            config::save_config,
            dbs::start_database,
            dbs::stop_database,
            cmds::auth::get_user_by_email_pwd,
            cmds::database_cmd::export_db,
            cmds::comptebancaire::get_all_comptebancaires,
            cmds::comptebancaire::get_comptebancaire_by_id,
            cmds::comptebancaire::update_comptebancaire,
            cmds::comptebancaire::delete_comptebancaire,
            cmds::comptebancaire::insert_comptebancaire,
            cmds::depense::get_all_depenses,
            cmds::depense::get_depense_by_id,
            cmds::depense::update_depense,
            cmds::depense::delete_depense,
            cmds::depense::insert_depense,
            cmds::document::get_all_documents,
            cmds::document::get_document_by_id,
            cmds::document::update_document,
            cmds::document::delete_document,
            cmds::document::insert_document,
            cmds::emballage::get_all_emballages,
            cmds::emballage::get_emballage_by_id,
            cmds::emballage::update_emballage,
            cmds::emballage::delete_emballage,
            cmds::emballage::insert_emballage,
            cmds::entreprise::get_all_entreprises,
            cmds::entreprise::get_entreprise_by_id,
            cmds::entreprise::update_entreprise,
            cmds::entreprise::delete_entreprise,
            cmds::entreprise::insert_entreprise,
            cmds::equipement::get_all_equipements,
            cmds::equipement::get_equipement_by_id,
            cmds::equipement::update_equipement,
            cmds::equipement::delete_equipement,
            cmds::equipement::insert_equipement,
            cmds::facture::get_all_factures,
            cmds::facture::get_facture_by_id,
            cmds::facture::update_facture,
            cmds::facture::delete_facture,
            cmds::facture::insert_facture,
            cmds::factureexport::get_all_factureexports,
            cmds::factureexport::get_factureexport_by_id,
            cmds::factureexport::update_factureexport,
            cmds::factureexport::delete_factureexport,
            cmds::factureexport::insert_factureexport,
            cmds::fournisseur::get_all_fournisseurs,
            cmds::fournisseur::get_fournisseur_by_id,
            cmds::fournisseur::update_fournisseur,
            cmds::fournisseur::delete_fournisseur,
            cmds::fournisseur::insert_fournisseur,
            cmds::lieustockage::get_all_lieustockages,
            cmds::lieustockage::get_lieustockage_by_id,
            cmds::lieustockage::update_lieustockage,
            cmds::lieustockage::delete_lieustockage,
            cmds::lieustockage::insert_lieustockage,
            cmds::lieutravail::get_all_lieutravails,
            cmds::lieutravail::get_lieutravail_by_id,
            cmds::lieutravail::update_lieutravail,
            cmds::lieutravail::delete_lieutravail,
            cmds::lieutravail::insert_lieutravail,
            cmds::local::get_all_locals,
            cmds::local::get_local_by_id,
            cmds::local::update_local,
            cmds::local::delete_local,
            cmds::local::insert_local,
            cmds::paiement::get_all_paiements,
            cmds::paiement::get_paiement_by_id,
            cmds::paiement::update_paiement,
            cmds::paiement::delete_paiement,
            cmds::paiement::insert_paiement,
            cmds::personnel::get_all_personnels,
            cmds::personnel::get_personnel_by_id,
            cmds::personnel::update_personnel,
            cmds::personnel::delete_personnel,
            cmds::personnel::insert_personnel,
            cmds::produit::get_all_produits,
            cmds::produit::get_produit_by_id,
            cmds::produit::update_produit,
            cmds::produit::delete_produit,
            cmds::produit::insert_produit,
            cmds::saison::get_all_saisons,
            cmds::saison::get_saison_by_id,
            cmds::saison::update_saison,
            cmds::saison::delete_saison,
            cmds::saison::insert_saison,
            cmds::session::get_all_sessions,
            cmds::session::get_session_by_id,
            cmds::session::update_session,
            cmds::session::delete_session,
            cmds::session::insert_session,
            cmds::setting::get_all_settings,
            cmds::setting::get_setting_by_id,
            cmds::setting::update_setting,
            cmds::setting::delete_setting,
            cmds::setting::insert_setting,
            cmds::tableachat::get_all_tableachats,
            cmds::tableachat::get_all_opps_achat_multi_db,
            cmds::tableachat::get_tableachat_by_id,
            cmds::tableachat::update_tableachat,
            cmds::tableachat::delete_tableachat,
            cmds::tableachat::insert_tableachat,
            cmds::tablearchivedoc::get_all_tablearchivedocs,
            cmds::tablearchivedoc::get_tablearchivedoc_by_id,
            cmds::tablearchivedoc::update_tablearchivedoc,
            cmds::tablearchivedoc::delete_tablearchivedoc,
            cmds::tablearchivedoc::insert_tablearchivedoc,
            cmds::tabledepense::get_all_tabledepenses,
            cmds::tabledepense::get_tabledepense_by_id,
            cmds::tabledepense::update_tabledepense,
            cmds::tabledepense::delete_tabledepense,
            cmds::tabledepense::insert_tabledepense,
            cmds::tabledocdoc::get_all_tabledocdocs,
            cmds::tabledocdoc::get_tabledocdoc_by_id,
            cmds::tabledocdoc::update_tabledocdoc,
            cmds::tabledocdoc::delete_tabledocdoc,
            cmds::tabledocdoc::insert_tabledocdoc,
            cmds::tablefactureavoir::get_all_tablefactureavoirs,
            cmds::tablefactureavoir::get_tablefactureavoir_by_id,
            cmds::tablefactureavoir::update_tablefactureavoir,
            cmds::tablefactureavoir::delete_tablefactureavoir,
            cmds::tablefactureavoir::insert_tablefactureavoir,
            cmds::tablepointage::get_all_tablepointages,
            cmds::tablepointage::get_tablepointage_by_id,
            cmds::tablepointage::update_tablepointage,
            cmds::tablepointage::delete_tablepointage,
            cmds::tablepointage::insert_tablepointage,
            cmds::tableressourceachat::get_all_tableressourceachats,
            cmds::tableressourceachat::get_all_ress_achat_multi_db,
            cmds::tableressourceachat::get_tableressourceachat_by_id,
            cmds::tableressourceachat::update_tableressourceachat,
            cmds::tableressourceachat::delete_tableressourceachat,
            cmds::tableressourceachat::insert_tableressourceachat,
            cmds::tableressourcevente::get_all_tableressourceventes,
            cmds::tableressourcevente::get_tableressourcevente_by_id,
            cmds::tableressourcevente::update_tableressourcevente,
            cmds::tableressourcevente::delete_tableressourcevente,
            cmds::tableressourcevente::insert_tableressourcevente,
            cmds::tabletransfert::get_all_tabletransferts,
            cmds::tabletransfert::get_tabletransfert_by_id,
            cmds::tabletransfert::update_tabletransfert,
            cmds::tabletransfert::delete_tabletransfert,
            cmds::tabletransfert::insert_tabletransfert,
            cmds::tablevente::get_all_tableventes,
            cmds::tablevente::get_tablevente_by_id,
            cmds::tablevente::update_tablevente,
            cmds::tablevente::delete_tablevente,
            cmds::tablevente::insert_tablevente,
            cmds::typeproduit::get_all_typeproduits,
            cmds::typeproduit::get_typeproduit_by_id,
            cmds::typeproduit::update_typeproduit,
            cmds::typeproduit::delete_typeproduit,
            cmds::typeproduit::insert_typeproduit,
            cmds::user::get_all_users,
            cmds::user::get_user_by_id,
            cmds::user::update_user,
            cmds::user::delete_user,
            cmds::user::insert_user,
            //get from all databases
            cmds::fournisseur::get_all_fournisseurs_multi_db,
            //helpers
            cmds::helper_functions::get_totaux,
            cmds::helper_functions::get_totaux_ress,
            cmds::helper_functions::get_totaux_opps
        ])
        // .manage(Arc::new(db))
        .run(tauri::generate_context!())
        .expect("error while running tauri application");
}
